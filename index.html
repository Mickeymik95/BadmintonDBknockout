<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <title>Sistem Double Elimination Pro</title>
    <style>
        :root {
            --win: #2ecc71; --lose: #e74c3c; --primary: #00ffcc;
            --bg: #121212; --card: #1e1e1e;
        }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: white; padding: 20px; }
        
        .controls { background: var(--card); padding: 20px; border-radius: 8px; margin-bottom: 30px; display: flex; gap: 15px; align-items: center; border: 1px solid #333; }
        input { padding: 8px; border-radius: 4px; border: 1px solid #444; background: #000; color: white; width: 60px; }
        button { padding: 8px 20px; background: var(--primary); border: none; border-radius: 4px; cursor: pointer; font-weight: bold; }

        .bracket-wrapper { display: flex; flex-direction: column; gap: 50px; }
        .bracket-row { display: flex; gap: 30px; padding-bottom: 20px; overflow-x: auto; align-items: flex-start; }
        
        .round-container { display: flex; flex-direction: column; gap: 20px; min-width: 180px; }
        .round-title { font-size: 0.7rem; color: var(--primary); font-weight: bold; margin-bottom: 10px; text-transform: uppercase; border-bottom: 1px solid #333; }

        .match-box { background: #252525; border: 1px solid #333; border-radius: 6px; overflow: hidden; }
        .match-id { font-size: 0.6rem; background: #333; padding: 2px 8px; color: #bbb; }
        
        .team { display: flex; justify-content: space-between; align-items: center; padding: 8px; border-bottom: 1px solid #333; }
        .team:last-child { border-bottom: none; }
        .score { width: 30px; height: 25px; border: none; background: #111; color: white; text-align: center; border-radius: 3px; font-weight: bold; }
        
        /* State Colors */
        .winner { background: var(--win) !important; color: white; }
        .loser { background: var(--lose) !important; color: white; opacity: 0.6; }

        h2 { color: var(--primary); font-size: 1.2rem; margin-bottom: 15px; }
    </style>
</head>
<body>

    <div class="controls">
        <label>Bilangan Pasukan:</label>
        <input type="number" id="teamInput" value="8" min="4">
        <button onclick="generateTournament()">Bina Tournament</button>
    </div>

    <div class="bracket-wrapper">
        <div id="winnersSection">
            <h2>Laluan Atas (Winners Bracket)</h2>
            <div id="winnersRow" class="bracket-row"></div>
        </div>

        <div id="losersSection">
            <h2>Laluan Bawah (Losers Bracket - Penyingkiran)</h2>
            <div id="losersRow" class="bracket-row"></div>
        </div>
    </div>

    <script>
        let matchCount = 1;

        function generateTournament() {
            const n = parseInt(document.getElementById('teamInput').value);
            const wRow = document.getElementById('winnersRow');
            const lRow = document.getElementById('losersRow');
            wRow.innerHTML = ''; lRow.innerHTML = '';
            matchCount = 1;

            let rounds = Math.ceil(Math.log2(n));

            // 1. WINNERS BRACKET
            for (let r = 1; r <= rounds + 1; r++) {
                let matchesInRound = Math.pow(2, rounds - r);
                if (r > rounds) matchesInRound = 1; // Grand Final

                const roundDiv = document.createElement('div');
                roundDiv.className = 'round-container';
                roundDiv.innerHTML = `<div class="round-title">${r > rounds ? 'Grand Final' : 'Winners R' + r}</div>`;

                for (let m = 0; m < matchesInRound; m++) {
                    roundDiv.appendChild(createMatchCard(matchCount++));
                }
                wRow.appendChild(roundDiv);
            }

            // 2. LOSERS BRACKET
            // Bilangan pusingan Losers adalah 2 * (rounds - 1)
            let loserRounds = (rounds - 1) * 2;
            for (let r = 1; r <= loserRounds; r++) {
                const roundDiv = document.createElement('div');
                roundDiv.className = 'round-container';
                roundDiv.innerHTML = `<div class="round-title">Losers R${r}</div>`;

                // Logik Losers: Bilangan match berkurang setiap 2 pusingan
                // Pusingan 1&2: sama, 3&4: sama, dsb.
                let matchesInLoserRound = Math.pow(2, Math.floor((loserRounds - r) / 2));

                for (let m = 0; m < matchesInLoserRound; m++) {
                    roundDiv.appendChild(createMatchCard(matchCount++));
                }
                lRow.appendChild(roundDiv);
            }
        }

        function createMatchCard(id) {
            const div = document.createElement('div');
            div.className = 'match-box';
            div.innerHTML = `
                <div class="match-id">PERLAWANAN #${id}</div>
                <div class="team">
                    <span>Pasukan A</span>
                    <input type="number" class="score" oninput="updateScore(this)">
                </div>
                <div class="team">
                    <span>Pasukan B</span>
                    <input type="number" class="score" oninput="updateScore(this)">
                </div>
            `;
            return div;
        }

        function updateScore(input) {
            const parent = input.closest('.match-box');
            const scores = parent.querySelectorAll('.score');
            const s1 = parseInt(scores[0].value);
            const s2 = parseInt(scores[1].value);

            scores[0].classList.remove('winner', 'loser');
            scores[1].classList.remove('winner', 'loser');

            if (!isNaN(s1) && !isNaN(s2)) {
                if (s1 > s2) {
                    scores[0].classList.add('winner');
                    scores[1].classList.add('loser');
                } else if (s2 > s1) {
                    scores[1].classList.add('winner');
                    scores[0].classList.add('loser');
                }
            }
        }

        generateTournament();
    </script>
</body>
</html>
